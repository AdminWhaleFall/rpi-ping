<!--
 * @Author: WhaleFall
 * @Date: 2021-10-17 01:23:34
 * @LastEditTime: 2021-10-17 02:06:32
 * @Description: 
-->
# 树莓派服务器监控上传实现
## 运行
1. 本程序通过 `systemctl` 实现开机自启和进程守护,即一直在后台运行,依赖`Python3`的定时模块`schedule`定时执行任务(支持多线程).
2. 程序所有操作均保存在`log`日志文件中.滚动保存7天.
## 上传信息
1. 每隔5分钟
   获取温湿度,拍摄环境图片.以时间命名放在`/photos/2021-10-17/2-06-11.jpg`文件夹.
   树莓派向 `upload uri` 上传温湿度(/rpi/ping/)和图片(/rpi/upload_photo)
   > 图片通过`openCV`控制树莓派摄像头拍照,添加时间和当前温湿度.
   > 服务端将温湿度写入数据库,图片保存最近的5张到指定目录,前端显示.
   > 前端实现折线图显示温度,
   > 利用`retry`模块上传失败时重试5次并将失败写日志.
## 检测网络
1. 每隔2分钟
   比对云端FRP配置(/rpi/frpc.ini)与本地配置是否一样,若不一样则覆盖本地配置并重启FRPC运行结果发邮件.
   检测frp服务器可用性[检测对应连接端口是否开放,读取配置文件中的相关字段],若不可用(写日志)->检查百度访问状态-> [联网成功!->发FRP失效邮件#上传网站msg(/rpi/msg/) or 无法联网!->写日志]


